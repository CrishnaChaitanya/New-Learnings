fields @timestamp, @message
| filter ("stepName" = "copy" and "username" != "")
  or "CONNECTED" in @message
| parse @message /"username":\s*"(?<company_name>[^"]+)"/ as company_name
| parse @message /"User":(?<company_name>[^ ]+)/ as company_name_connected
| stats count(distinct company_name) as FileUploadUsers, count(distinct company_name_connected) as InfraOnlyUsers by bin(@timestamp, 1h)
| sort @timestamp desc
